<mxGraphModel dx="1030" dy="520" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" fold="1" page="1" pageScale="1" pageWidth="826" pageHeight="1169" style="default-style2" math="0"><root><mxCell id="0"/><mxCell id="1" parent="0"/><mxCell id="2" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center ; text-decoration: underline&quot;&gt;&lt;strong&gt;Privileged&lt;br&gt;&lt;/strong&gt;&lt;/p&gt;&lt;hr&gt;access password&lt;br&gt;database and all&lt;br&gt;data&lt;br&gt;&lt;br&gt;&lt;hr&gt;verify auth request&lt;br&gt;&lt;br&gt;pass authticated&lt;br&gt;requests to VC&lt;br&gt;child or disconnect" style="verticalAlign=middle;align=center;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;rounded=1;fontStyle=1;strokeWidth=3;fillColor=#E6FFCC" parent="1" vertex="1"><mxGeometry x="180" y="355" width="120" height="195" as="geometry"/></mxCell><mxCell id="6" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center ; text-decoration: underline&quot;&gt;&lt;strong&gt;&lt;br&gt;&lt;/strong&gt;&lt;/p&gt;&lt;hr&gt;access local&lt;br&gt;database only&lt;br&gt;" style="verticalAlign=middle;align=center;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;rounded=1;fontStyle=1;strokeWidth=3;fillColor=#E6FFCC" parent="1" vertex="1"><mxGeometry x="390" y="146" width="110" height="74" as="geometry"/></mxCell><mxCell id="55" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;strokeColor=#990000;strokeWidth=2;entryX=0;entryY=0.333;entryPerimeter=0;exitX=1;exitY=0.342;exitPerimeter=0" parent="1" edge="1"><mxGeometry width="100" height="100" relative="1" as="geometry"><mxPoint x="300" y="419.95000000000005" as="sourcePoint"/><mxPoint x="510" y="419.92600000000004" as="targetPoint"/><Array as="points"><mxPoint x="330" y="458"/></Array></mxGeometry></mxCell><mxCell id="58" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;strokeColor=#990000;strokeWidth=2;exitX=1;exitY=0.2;entryX=0;entryY=0.75;exitPerimeter=0" parent="1" source="2" target="6" edge="1"><mxGeometry width="100" height="100" relative="1" as="geometry"><mxPoint x="440" y="390" as="sourcePoint"/><mxPoint x="480" y="270" as="targetPoint"/><Array as="points"><mxPoint x="310" y="270"/></Array></mxGeometry></mxCell><mxCell id="60" value="fork workers (instances of&#xa;Versioned Collection)" style="text;spacingTop=-5;align=center" parent="1" vertex="1"><mxGeometry x="310" y="306" width="150" height="33" as="geometry"/></mxCell><mxCell id="98" value="pass authenticated&#xa;connection to start&#xa;receiving BSON data" style="text;align=center;verticalAlign=middle;" parent="1" vertex="1"><mxGeometry x="130" y="237" width="160" height="94" as="geometry"/></mxCell><mxCell id="100" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center ; text-decoration: underline&quot;&gt;&lt;strong&gt;Unprivileged&lt;/strong&gt;&lt;/p&gt;&lt;hr&gt;pre-auth&lt;br&gt;chrooted and dropped privileges&lt;br&gt;&lt;br&gt;handle incoming connections&lt;br&gt;&lt;br&gt;parse incoming connections&lt;br&gt;for newline separated JSON&lt;br&gt;objects&lt;br&gt;&lt;br&gt;expect exactly one valid&lt;br&gt;auth request&lt;br&gt;&amp;nbsp;per connection&lt;br&gt;" style="verticalAlign=middle;align=center;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;rounded=1;fontStyle=1;strokeWidth=3;fillColor=#E6FFCC" parent="1" vertex="1"><mxGeometry x="510" y="358" width="200" height="222" as="geometry"/></mxCell><mxCell id="107" value="send auth request and &#xa;connection socket&#xa;" style="text;align=center;verticalAlign=middle;" parent="1" vertex="1"><mxGeometry x="345" y="500" width="130" height="50" as="geometry"/></mxCell><mxCell id="117" value="&lt;table style=&quot;width: 100% ; height: 100% ; border-collapse: collapse&quot; border=&quot;1&quot; cellpadding=&quot;4&quot; width=&quot;100%&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th align=&quot;center&quot;&gt;&lt;b&gt;Auth request&lt;br&gt;&lt;/b&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr align=&quot;left&quot;&gt;&lt;td&gt;&lt;ul&gt;&lt;li&gt;username&lt;/li&gt;&lt;li&gt;password&lt;/li&gt;&lt;li&gt;database&lt;/li&gt;&lt;li&gt;collection&lt;/li&gt;&lt;li&gt;offset&lt;/li&gt;&lt;/ul&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td align=&quot;center&quot;&gt;&lt;br&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;" style="text;html=1;overflow=fill;" parent="1" vertex="1"><mxGeometry x="640" y="150" width="160" height="160" as="geometry"/></mxCell><mxCell id="120" value="fork unprivileged connection&#xa;handler" style="text;align=center;verticalAlign=middle;" vertex="1" parent="1"><mxGeometry x="370" y="420" width="80" height="40" as="geometry"/></mxCell><mxCell id="126" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;strokeColor=#990000;strokeWidth=2;" edge="1" parent="1"><mxGeometry width="100" height="100" relative="1" as="geometry"><mxPoint x="510" y="500" as="sourcePoint"/><mxPoint x="300" y="500" as="targetPoint"/><Array as="points"><mxPoint x="400" y="522"/></Array></mxGeometry></mxCell><mxCell id="128" value="" style="curved=1;endArrow=classic;exitX=0;exitY=0.778;exitPerimeter=0;entryX=0;entryY=0.324;entryPerimeter=0;strokeWidth=2;strokeColor=#990000" edge="1" parent="1" source="2" target="6"><mxGeometry width="100" height="100" relative="1" as="geometry"><mxPoint x="55" y="560" as="sourcePoint"/><mxPoint x="320" y="140" as="targetPoint"/><Array as="points"><mxPoint x="110" y="400"/><mxPoint x="190" y="140"/></Array></mxGeometry></mxCell><mxCell id="133" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;strokeColor=#990000;strokeWidth=2;" edge="1" parent="1" source="136"><mxGeometry width="100" height="100" relative="1" as="geometry"><mxPoint x="520" y="190" as="sourcePoint"/><mxPoint x="600" y="358" as="targetPoint"/><Array as="points"><mxPoint x="600" y="270"/></Array></mxGeometry></mxCell><mxCell id="134" value="send auth request&#xa;to remote" style="text;spacingTop=-5;align=center" vertex="1" parent="1"><mxGeometry x="470" y="251" width="150" height="33" as="geometry"/></mxCell><mxCell id="135" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center ; text-decoration: underline&quot;&gt;&lt;strong&gt;&lt;br&gt;&lt;/strong&gt;&lt;/p&gt;&lt;hr&gt;access local&lt;br&gt;database only&lt;br&gt;" style="verticalAlign=middle;align=center;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;rounded=1;fontStyle=1;strokeWidth=3;fillColor=#E6FFCC" vertex="1" parent="1"><mxGeometry x="400" y="156" width="110" height="74" as="geometry"/></mxCell><mxCell id="136" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center ; text-decoration: underline&quot;&gt;&lt;strong&gt;VC privileged&lt;/strong&gt;&lt;/p&gt;&lt;hr&gt;access local&lt;br&gt;database only&lt;br&gt;" style="verticalAlign=middle;align=center;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;rounded=1;fontStyle=1;strokeWidth=3;fillColor=#E6FFCC" vertex="1" parent="1"><mxGeometry x="410" y="166" width="110" height="74" as="geometry"/></mxCell></root></mxGraphModel>