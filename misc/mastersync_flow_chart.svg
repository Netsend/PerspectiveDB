<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="791px" height="448px" version="1.1"><defs/><g transform="translate(0.5,0.5)"><rect x="79" y="220" width="120" height="195" rx="18" ry="18" fill="#e6ffcc" stroke="#000000" stroke-width="3" pointer-events="none"/><g transform="translate(78,220)"><switch><foreignObject pointer-events="all" width="122" height="197" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 120px; height: 195px; white-space: nowrap; font-weight: bold; text-align: center;"><p style="margin: 0px ; margin-top: 4px ; text-align: center ; text-decoration: underline"><strong>Privileged<br /></strong></p><hr />access password<br />database and all<br />data<br /><br /><hr />verify auth request<br /><br />pass authticated<br />requests to VC<br />child or disconnect</div></foreignObject><text x="61" y="105" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica" font-weight="bold">[Not supported by viewer]</text></switch></g><rect x="284" y="7" width="110" height="74" rx="11" ry="11" fill="#e6ffcc" stroke="#000000" stroke-width="3" pointer-events="none"/><g transform="translate(283,7)"><switch><foreignObject pointer-events="all" width="112" height="76" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 110px; height: 74px; white-space: nowrap; font-weight: bold; text-align: center;"><p style="margin: 0px ; margin-top: 4px ; text-align: center ; text-decoration: underline"><strong><br /></strong></p><hr />access local<br />database only<br /></div></foreignObject><text x="56" y="44" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica" font-weight="bold">[Not supported by viewer]</text></switch></g><path d="M 199 285 L 219 285 Q 229 285 239 285 L 401 285" fill="none" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 407 285 L 399 289 L 401 285 L 399 281 Z" fill="#990000" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 199 259 L 204 259 Q 209 259 209 249 L 209 73 Q 209 63 219 63 L 276 63" fill="none" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 282 63 L 274 67 L 276 63 L 274 59 Z" fill="#990000" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="209" y="171" width="150" height="33" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="284" y="184">fork workers (instances of</text><text x="284" y="198">Versioned Collection)</text></g><rect x="39" y="133" width="160" height="94" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="119" y="170">send data request and</text><text x="119" y="184">authenticated connection</text><text x="119" y="198"> socket to the requested VC</text></g><rect x="409" y="223" width="200" height="222" rx="30" ry="30" fill="#e6ffcc" stroke="#000000" stroke-width="3" pointer-events="none"/><g transform="translate(408,223)"><switch><foreignObject pointer-events="all" width="202" height="224" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 200px; height: 222px; white-space: nowrap; font-weight: bold; text-align: center;"><p style="margin: 0px ; margin-top: 4px ; text-align: center ; text-decoration: underline"><strong>Unprivileged</strong></p><hr />pre-auth<br />chrooted and dropped privileges<br /><br />handle incoming connections<br /><br />parse incoming connections<br />for newline separated JSON<br />objects<br /><br />expect exactly one valid<br />auth request<br />Â per connection<br /></div></foreignObject><text x="101" y="118" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica" font-weight="bold">[Not supported by viewer]</text></switch></g><rect x="244" y="365" width="130" height="50" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="309" y="380">send auth request and </text><text x="309" y="394">connection socket</text></g><rect x="629" y="1" width="160" height="160" fill="none" stroke="none" pointer-events="none"/><g transform="translate(629,1)"><switch><foreignObject pointer-events="all" width="162" height="162" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 160px; height: 160px; white-space: nowrap;"><table width="100%" cellpadding="4" border="1" style="width: 100% ; height: 100% ; border-collapse: collapse"><tbody><tr><th align="center"><b>Auth request<br /></b></th></tr><tr align="left"><td><ul><li>username</li><li>password</li><li>database</li><li>collection</li><li>offset</li></ul></td></tr><tr><td align="center"><br /></td></tr></tbody></table></div></foreignObject><text x="81" y="87" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="269" y="285" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="309" y="302">fork unprivileged connection</text><text x="309" y="316">handler</text></g><path d="M 409 365 L 309 365 Q 299 365 289 365 L 207 365" fill="none" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 201 365 L 209 361 L 207 365 L 209 369 Z" fill="#990000" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 79 372 Q 9 265 54 150 Q 99 35 276 44" fill="none" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 282 44 L 274 47 L 276 44 L 274 40 Z" fill="#990000" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 414 68 L 489 68 Q 499 68 499 78 L 499 215" fill="none" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 499 221 L 495 213 L 499 215 L 503 213 Z" fill="#990000" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="369" y="116" width="150" height="33" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="444" y="129">send auth request</text><text x="444" y="143">to remote</text></g><rect x="294" y="21" width="110" height="74" rx="11" ry="11" fill="#e6ffcc" stroke="#000000" stroke-width="3" pointer-events="none"/><g transform="translate(293,21)"><switch><foreignObject pointer-events="all" width="112" height="76" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 110px; height: 74px; white-space: nowrap; font-weight: bold; text-align: center;"><p style="margin: 0px ; margin-top: 4px ; text-align: center ; text-decoration: underline"><strong><br /></strong></p><hr />access local<br />database only<br /></div></foreignObject><text x="56" y="44" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica" font-weight="bold">[Not supported by viewer]</text></switch></g><rect x="304" y="31" width="110" height="74" rx="11" ry="11" fill="#e6ffcc" stroke="#000000" stroke-width="3" pointer-events="none"/><g transform="translate(303,31)"><switch><foreignObject pointer-events="all" width="112" height="76" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 110px; height: 74px; white-space: nowrap; font-weight: bold; text-align: center;"><p style="margin: 0px ; margin-top: 4px ; text-align: center ; text-decoration: underline"><strong>VC privileged</strong></p><hr />access local<br />database only<br /></div></foreignObject><text x="56" y="44" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica" font-weight="bold">[Not supported by viewer]</text></switch></g><rect x="629" y="205" width="160" height="160" fill="none" stroke="none" pointer-events="none"/><g transform="translate(629,205)"><switch><foreignObject pointer-events="all" width="162" height="162" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 160px; height: 160px; white-space: nowrap;"><table width="100%" cellpadding="4" border="1" style="width: 100% ; height: 100% ; border-collapse: collapse"><tbody><tr><th align="center"><b>Data request<br /></b></th></tr><tr align="left"><td><ul><li>[filter]</li><li>[hooks]</li><li>[hooksOpts]</li><li>[offset]</li></ul></td></tr><tr><td align="center"><br /></td></tr></tbody></table></div></foreignObject><text x="81" y="87" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g></g></svg>