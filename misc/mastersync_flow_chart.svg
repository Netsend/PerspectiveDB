<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="701px" height="452px" version="1.1"><defs/><g transform="translate(0.5,0.5)"><rect x="79" y="224" width="120" height="195" rx="18" ry="18" fill="#e6ffcc" stroke="#000000" stroke-width="3" pointer-events="none"/><g transform="translate(78,224)"><switch><foreignObject pointer-events="all" width="122" height="197" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 120px; height: 195px; white-space: nowrap; font-weight: bold; text-align: center;"><p style="margin: 0px ; margin-top: 4px ; text-align: center ; text-decoration: underline"><strong>Privileged<br /></strong></p><hr />access password<br />database and all<br />data<br /><br /><hr />verify auth request<br /><br />pass authticated<br />requests to VC<br />child or disconnect</div></foreignObject><text x="61" y="105" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica" font-weight="bold">[Not supported by viewer]</text></switch></g><rect x="289" y="15" width="110" height="74" rx="11" ry="11" fill="#e6ffcc" stroke="#000000" stroke-width="3" pointer-events="none"/><g transform="translate(288,15)"><switch><foreignObject pointer-events="all" width="112" height="76" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 110px; height: 74px; white-space: nowrap; font-weight: bold; text-align: center;"><p style="margin: 0px ; margin-top: 4px ; text-align: center ; text-decoration: underline"><strong><br /></strong></p><hr />access local<br />database only<br /></div></foreignObject><text x="56" y="44" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica" font-weight="bold">[Not supported by viewer]</text></switch></g><path d="M 199 289 L 219 289 Q 229 289 239 289 L 401 289" fill="none" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 407 289 L 399 293 L 401 289 L 399 285 Z" fill="#990000" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 199 263 L 204 263 Q 209 263 209 253 L 209 81 Q 209 71 219 71 L 281 71" fill="none" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 287 71 L 279 75 L 281 71 L 279 67 Z" fill="#990000" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="209" y="175" width="150" height="33" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="284" y="188">fork workers (instances of</text><text x="284" y="202">Versioned Collection)</text></g><rect x="29" y="106" width="160" height="94" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="109" y="143">pass authenticated</text><text x="109" y="157">connection to start</text><text x="109" y="171">receiving BSON data</text></g><rect x="409" y="227" width="200" height="222" rx="30" ry="30" fill="#e6ffcc" stroke="#000000" stroke-width="3" pointer-events="none"/><g transform="translate(408,227)"><switch><foreignObject pointer-events="all" width="202" height="224" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 200px; height: 222px; white-space: nowrap; font-weight: bold; text-align: center;"><p style="margin: 0px ; margin-top: 4px ; text-align: center ; text-decoration: underline"><strong>Unprivileged</strong></p><hr />pre-auth<br />chrooted and dropped privileges<br /><br />handle incoming connections<br /><br />parse incoming connections<br />for newline separated JSON<br />objects<br /><br />expect exactly one valid<br />auth request<br />Â per connection<br /></div></foreignObject><text x="101" y="118" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica" font-weight="bold">[Not supported by viewer]</text></switch></g><rect x="244" y="369" width="130" height="50" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="309" y="384">send auth request and </text><text x="309" y="398">connection socket</text></g><rect x="539" y="19" width="160" height="160" fill="none" stroke="none" pointer-events="none"/><g transform="translate(539,19)"><switch><foreignObject pointer-events="all" width="162" height="162" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 160px; height: 160px; white-space: nowrap;"><table width="100%" cellpadding="4" border="1" style="width: 100% ; height: 100% ; border-collapse: collapse"><tbody><tr><th align="center"><b>Auth request<br /></b></th></tr><tr align="left"><td><ul><li>username</li><li>password</li><li>database</li><li>collection</li><li>offset</li></ul></td></tr><tr><td align="center"><br /></td></tr></tbody></table></div></foreignObject><text x="81" y="87" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="269" y="289" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="309" y="306">fork unprivileged connection</text><text x="309" y="320">handler</text></g><path d="M 409 369 L 309 369 Q 299 369 289 369 L 207 369" fill="none" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 201 369 L 209 365 L 207 369 L 209 373 Z" fill="#990000" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 79 376 Q 9 269 49 139 Q 89 9 281 38" fill="none" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 287 39 L 278 41 L 281 38 L 279 34 Z" fill="#990000" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 419 72 L 489 72 Q 499 72 499 82 L 499 219" fill="none" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 499 225 L 495 217 L 499 219 L 503 217 Z" fill="#990000" stroke="#990000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="369" y="120" width="150" height="33" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="444" y="133">send auth request</text><text x="444" y="147">to remote</text></g><rect x="299" y="25" width="110" height="74" rx="11" ry="11" fill="#e6ffcc" stroke="#000000" stroke-width="3" pointer-events="none"/><g transform="translate(298,25)"><switch><foreignObject pointer-events="all" width="112" height="76" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 110px; height: 74px; white-space: nowrap; font-weight: bold; text-align: center;"><p style="margin: 0px ; margin-top: 4px ; text-align: center ; text-decoration: underline"><strong><br /></strong></p><hr />access local<br />database only<br /></div></foreignObject><text x="56" y="44" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica" font-weight="bold">[Not supported by viewer]</text></switch></g><rect x="309" y="35" width="110" height="74" rx="11" ry="11" fill="#e6ffcc" stroke="#000000" stroke-width="3" pointer-events="none"/><g transform="translate(308,35)"><switch><foreignObject pointer-events="all" width="112" height="76" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 110px; height: 74px; white-space: nowrap; font-weight: bold; text-align: center;"><p style="margin: 0px ; margin-top: 4px ; text-align: center ; text-decoration: underline"><strong>VC privileged</strong></p><hr />access local<br />database only<br /></div></foreignObject><text x="56" y="44" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica" font-weight="bold">[Not supported by viewer]</text></switch></g></g></svg>